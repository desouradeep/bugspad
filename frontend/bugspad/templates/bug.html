{% extends "base.html" %}

{% block js %}
{{ super() }}
<script>
$(function () {
    function toggleAdvancedFieldsHandler (e) {
        e.preventDefault();
        var $fieldset = $('fieldset#advanced');
        if ($fieldset.css('display') == 'none') {
            $fieldset.slideDown();
            $('#toggle-advanced-fields-button').html('Hide advanced fields <i class="icon-chevron-down"></i>');
        } else {
            $fieldset.slideUp(function () {
                $('#toggle-advanced-fields-button').html(
                    'Show advanced fields <i class="icon-chevron-right"></i>');
            });
        }
    }
    $('#toggle-advanced-fields-button').bind('click', toggleAdvancedFieldsHandler);
});
</script>
{% endblock %}

{%- macro dual_form_row(col_one_fields, col_two_fields) %}
<div class="row-fluid">
    <div class="span6">
        {%- for field in col_one_fields %}
        <div class="control-group {% if field.errors %}error{% endif %}">
          {{field.label(class="control-label", label=field.description)}}
          <div class="controls">
            {{field(class="span12", **kwargs)|safe}}

            {%- if field.errors %}
              {%- for error in field.errors %}
                <p class="help-block">{{error}}</p>
              {%- endfor %}
            {%- endif %}
          </div>
        </div>
        {%- endfor %}
    </div>
    <div class="span6">
        {%- for field in col_two_fields %}
        <div class="control-group {% if field.errors %}error{% endif %}">
          {{field.label(class="control-label", label=field.description)}}
          <div class="controls">
            {{field(class="span12", **kwargs)|safe}}

            {%- if field.errors %}
              {%- for error in field.errors %}
                <p class="help-block">{{error}}</p>
              {%- endfor %}
            {%- endif %}
          </div>
        </div>
        {%- endfor %}
    </div>
</div>
{%- endmacro %}

{%- macro full_width_field(field) %}
<div class="row-fluid">
    <div class="control-group {% if field.errors %}error{% endif %}">
      {{field.label(class="control-label", label=field.description)}}
      <div class="controls">
        {{field(class="span12", **kwargs)|safe}}

        {%- if field.errors %}
          {%- for error in field.errors %}
            <p class="help-block">{{error}}</p>
          {%- endfor %}
        {%- endif %}
      </div>
    </div>
</div>
{%- endmacro %}




{% block container_content %}
<form id="bugform" class="form span8">
    <fieldset id="basic_one">
        {{ dual_form_row([form.product], [form.reporter]) }}
        {{ full_width_field(form.component) }}
        {{ dual_form_row([form.version], [form.severity]) }}
        {{ dual_form_row([form.hardware], [form.os_choice]) }}
    </fieldset>

    <a href="#" id='toggle-advanced-fields-button'>Show advanced fields <i class="icon-chevron-right"></i></a>
    <fieldset id="advanced" style="display: none;">
      {{ dual_form_row([form.target_release]) }}
      {{ dual_form_row([form.status]) }}
      {{ dual_form_row([form.assignee], [form.fedora_review]) }}
      {{ dual_form_row([form.qa_contact], [form.release_note]) }}
      {{ dual_form_row([form.docs_contact], [form.need_info]) }}
      {{ dual_form_row([form.cc])}}
      {{ full_width_field(form.alias) }}
      {{ full_width_field(form.url) }}
      {{ full_width_field(form.whiteboard) }}
      {{ full_width_field(form.clone_of) }}
      {{ full_width_field(form.environment) }}
    </fieldset>
    <fieldset id="basic_two">
        {{ full_width_field(form.summary) }}
        {{ full_width_field(form.description) }}
        {{ full_width_field(form.attachment) }}
        <p><b>Add external Bug:</b></p>
        {{ dual_form_row([form.external_bug_location], [form.external_bug_bugid]) }}
    </fieldset>
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Submit</button>
    </div>
</form>
{% endblock %}

<script type="text/javascript">
  $(document).ready(function(){
    $('#advanced-button').click(function(){
      $('#advanced').toggle();
    }
  }
</script>
